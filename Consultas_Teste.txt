1.
SELECT 
	ID_VENDEDOR as id, 
	NOME as nome, 
	SALARIO as salario 
FROM VENDEDORES
WHERE inativo = FALSE
ORDER BY nome;

2.
SELECT 
    ID_VENDEDOR AS id, 
    NOME AS nome, 
    SALARIO AS salario
FROM VENDEDORES
WHERE SALARIO > (SELECT AVG(SALARIO) FROM VENDEDORES)
ORDER BY SALARIO DESC;

3.
SELECT 
     c.ID_CLIENTE as id, 
     c.RAZAO_SOCIAL as razao_social, 
     COALESCE(SUM(P.VALOR_TOTAL), 0) AS total FROM CLIENTES c
LEFT JOIN PEDIDO p ON p.ID_CLIENTE = c.ID_CLIENTE
GROUP BY c.ID_CLIENTE, c.RAZAO_SOCIAL
ORDER BY total DESC;

4.
SELECT 
    ID_PEDIDO AS id, 
    VALOR_TOTAL AS valor, 
    DATA_EMISSAO AS data, 
    CASE 
        WHEN DATA_CANCELAMENTO IS NOT NULL THEN 'CANCELADO'
        WHEN DATA_FATURAMENTO IS NOT NULL THEN 'FATURADO'
        ELSE 'PENDENTE'
    END AS situacao
FROM PEDIDO;


5.
SELECT 
    ip.ID_PRODUTO AS id_produto,
    SUM(ip.QUANTIDADE) AS quantidade_vendida,
    SUM(ip.PRECO_PRATICADO * ip.QUANTIDADE) AS total_vendido,
    COUNT(DISTINCT p.ID_CLIENTE) AS clientes,
    COUNT(DISTINCT ip.ID_PEDIDO) AS pedidos
FROM ITENS_PEDIDO ip
JOIN PEDIDO p ON ip.ID_PEDIDO = p.ID_PEDIDO
WHERE p.DATA_CANCELAMENTO IS NULL
GROUP BY ip.ID_PRODUTO
ORDER BY quantidade_vendida DESC, total_vendido DESC
LIMIT 1;
